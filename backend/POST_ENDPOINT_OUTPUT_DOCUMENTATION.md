📋 POST /api/issues/ ENDPOINT - COMPLETE OUTPUT DOCUMENTATION
========================================================================

🔧 FIXED CHANGES:
✅ Removed radius field from user input (IssueCreateRequest)
✅ Radius is now ONLY generated by AI using get_radius_from_text() function
✅ AI analyzes description and returns optimal radius (5m, 20m, 50m, or 100m)
✅ Function has failsafe: defaults to 500m if AI fails

📊 INPUT FORMAT (What User Sends):
```json
{
  "title": "Large pothole on Highway 101 causing traffic issues",
  "description": "There is a massive pothole near the gas station that's affecting a wide area of traffic. Cars are swerving dangerously around it and it's becoming a safety hazard for the entire stretch of road.",
  "location": "40.7128,-74.0060",
  "district": "Manhattan"
}
```

🤖 AI PROCESSING:
1. get_radius_from_text(description) → Analyzes text using system_prompt3.txt
2. AI returns one of: 5m, 20m, 50m, or 100m based on issue scope
3. get_category_from_text(description) → AI detects category using ML model
4. get_priority_from_text(description) → AI determines priority level
5. Authority auto-selected based on category + district

📤 OUTPUT FORMAT - SUCCESS (HTTP 201):
```json
{
  "message": "Issue created successfully",
  "issue": {
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "user_id": "987fcdeb-51a2-43d1-9c45-123456789abc", 
    "authority_id": "456e7890-12ab-34cd-5678-901234567def",
    "title": "Large pothole on Highway 101 causing traffic issues",
    "description": "There is a massive pothole near the gas station...",
    "status": 0,
    "location": "40.7128,-74.0060",
    "radius": 50,  // ← AI-GENERATED (not from user input)
    "created_at": "2025-01-08T10:30:00.000Z",
    "updated_at": "2025-01-08T10:30:00.000Z",
    "priority": 2,  // ← AI-DETERMINED (0=Low, 1=Medium, 2=High)
    "category": "Road Authority",  // ← AI-DETECTED
    "user": {
      "id": "987fcdeb-51a2-43d1-9c45-123456789abc",
      "name": "John Doe",
      "email": "john@example.com",
      "district": "Manhattan"
    },
    "authority": {
      "id": "456e7890-12ab-34cd-5678-901234567def",
      "name": "Manhattan Road Department",
      "district": "Manhattan", 
      "category": "Road Authority",
      "contact_email": "roads@manhattan.gov"
    },
    "votes": [],
    "media": [],
    "vote_count": 0
  }
}
```

📤 OUTPUT FORMAT - DUPLICATE FOUND (HTTP 400):
```json
{
  "message": "Similar issue already exists within 50m radius. Auto-upvoted existing issue instead.",
  "existing_issue": {
    "id": "existing-issue-uuid",
    "title": "Pothole on Highway 101",
    "description": "Dangerous pothole causing traffic issues",
    "location": "40.7130,-74.0058",
    "radius": 50,  // ← Original issue's AI-generated radius
    "status": 0,
    "priority": 2,
    "category": "Road Authority",
    "vote_count": 2,  // ← Incremented due to auto-upvote
    "user": { /* user details */ },
    "authority": { /* authority details */ },
    "votes": [ /* vote records */ ],
    "media": [ /* media files */ ]
  },
  "auto_upvoted": true,
  "distance_meters": 156.23  // ← Calculated distance between issues
}
```

🤖 AI RADIUS DETECTION LOGIC:
```
Input: "Large pothole near gas station affecting wide area of traffic"
AI Analysis: 
- Keywords: "wide area", "traffic", "affecting"
- Scope: Affects traffic flow beyond immediate spot
- Decision: 50m radius (neighborhood-level impact)

Other Examples:
- "Streetlight not working" → 5m (specific fixture)
- "Power cut in apartment complex" → 50m (building-wide)
- "Major road construction blocking highway" → 100m (large infrastructure)
```

🔍 KEY TECHNICAL DETAILS:
- AI Function: get_radius_from_text() using system_prompt3.txt
- Valid AI Responses: 5, 20, 50, 100 (meters)
- Fallback Radius: 500m if AI fails
- Duplicate Detection: Uses Haversine formula for accurate distance
- Distance Check: New issue location vs existing issues within AI-determined radius
- Auto-Upvote: If duplicate found, existing issue gets upvoted automatically

🚀 BENEFITS OF FIXED APPROACH:
✅ Consistent radius determination (no user guesswork)
✅ AI analyzes actual issue scope intelligently  
✅ Prevents duplicate submissions effectively
✅ Automatic engagement through upvoting
✅ Cleaner API (fewer user-provided parameters)
✅ Better data quality and issue management
